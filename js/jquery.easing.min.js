//Ajax鍒嗛〉
var pageList = function(obj, url, target) {
	$.getJSON(url, function(json) {
		if (json.status == 200) {
			$('#' + target).html(json.content);
			$('#' + target).ScrollTo(200);
		}
	})
}


$(function() {

	if ($('.flexslider').size()) {
		$('.flexslider').flexslider({
			animation: "slide",
			itemWidth: 1000,
			itemHeight: 500
		});
	}

	$(".unclor_layer").hover(
		function() {
			$(this).stop().animate({
				opacity: 0
			}, 250);
			$(this).parent().find('.play_layer').stop().fadeIn('fast');
			$(this).parent().find('.read_layer').stop().fadeIn('fast');
			var index = parseInt($(this).attr('rel'));

			if ($('#li_layer_' + index).next('.param_layer').size() > 0) {
				$('#li_layer_' + index).next('.param_layer').stop().animate({
					left: 250
				}, 350).show();
				$('#li_layer_' + (index + 1)).css('z-index', 0);
			} else {
				$('#li_layer_' + index).next('.param_left_layer').stop().animate({
					right: 250
				}, 350).show();
				$('#li_layer_' + (index - 1)).css('z-index', 0);
			}
		},
		function() {
			$(this).stop().animate({
				opacity: 0.3
			}, 250);
			$(this).parent().find('.play_layer').stop().fadeOut();
			$(this).parent().find('.read_layer').stop().fadeOut();
			var index = parseInt($(this).attr('rel'));

			if ($('#li_layer_' + index).next('.param_layer').size() > 0) {
				$('#li_layer_' + index).next('.param_layer').stop().animate({
					left: 0
				}, 350).hide();
				$('#li_layer_' + (index + 1)).css('z-index', 2);
			} else {
				$('#li_layer_' + index).next('.param_left_layer').stop().animate({
					right: 0
				}, 350).hide();
				$('#li_layer_' + (index - 1)).css('z-index', 2);
			}

		}
	);

	var page = location.hash;
	if (page.length > 0) {
		page = page.match(/page=([0-9])+/);
		page = page[1];

		if (page > 1) {
			pageList(this, '/index/index?page=' + 2, 'pageList');
		}
	}


	//鍔犺浇渚ц竟鏍�
	$.getJSON('/side', function(json) {
		if (json.status == 200) {
			$('#side').html(json.content);
			//鐢ㄦ埛鍚嶇墖銆佺淇�
			userCardInit();
		}
	})

	//绀句氦骞冲彴鐧诲綍
	if (getURLParam('l') == 's') {
		var obj = null;
		Navigate(obj, 'c');
	}

});